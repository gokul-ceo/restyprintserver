version: 2.1
workflows:
  testing:
    jobs:
      - printer-config
jobs:
  printer-config:
    machine: true
    resource_class: gokul-ceo/restyprintserver-rpi-v0
    steps:
      - run: git clone https://github.com/gokul-ceo/restyprintserver.git
      - run: cd restyprintserver
      - run:
          name: Installing restyprintserver
          command: |
            npm install
      - run:
          name: starting restyprintserver
          command: |
            node index.js
      - run:
          name: Restart the service
          command: |
            sudo systemctl daemon-reload
      - run:
          name: Start the service
          command: |
            sudo systemctl start restyprint.service